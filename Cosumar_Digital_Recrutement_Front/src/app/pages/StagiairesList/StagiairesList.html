<div class="stagiaires-list">
  <h2>Liste des Stagiaires</h2>
  
  <!-- Pagination info -->
  @if (!loading && totalCount > 0) {
    <div class="pagination-info">
      Affichage de {{ ((currentPage - 1) * pageSize) + 1 }} Ã  {{ getCurrentPageMax() }} sur {{ totalCount }} stagiaires
    </div>
  }
  
  @if (loading) {
    <div class="loading-spinner">
      <span class="spinner"></span> Chargement...
    </div>
  }
  @if (error) {
    <div class="error">{{ error }}</div>
  }
  @if (!loading && stagiaires.length) {
    <div class="table-container">
      <div class="scroll-hint">â† Faites glisser pour voir plus â†’</div>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Matricule</th>
            <th>Nom</th>
            <th>PrÃ©nom</th>
            <th>Email</th>
            <th>TÃ©lÃ©phone</th>
            <th>Date de Naissance</th>
            <th>Stage Actuel</th>
            <th>Statut du Stage</th>
            <th>Date de CrÃ©ation</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (stagiaire of stagiaires; track stagiaire.id; let i = $index) {
            <tr>
              <td>{{ ((currentPage - 1) * pageSize) + i + 1 }}</td>
              <td><strong>{{ stagiaire.matricule }}</strong></td>
              <td><strong>{{ stagiaire.nom }}</strong></td>
              <td>{{ stagiaire.prenom }}</td>
              <td class="email-cell">
                @if (stagiaire.email) {
                  <a href="mailto:{{ stagiaire.email }}">{{ stagiaire.email }}</a>
                } @else {
                  <span>-</span>
                }
              </td>
              <td>{{ stagiaire.num_tel || '-' }}</td>
              <td>{{ stagiaire.date_naissance | date:'dd/MM/yyyy' }}</td>
              <td>
                @if (stagiaire.latest_stage_nature) {
                  <span class="nature-badge">
                    {{ getNatureLabel(stagiaire.latest_stage_nature) }}
                  </span>
                } @else {
                  <span class="no-stage">Aucun stage</span>
                }
              </td>
              <td>
                @if (stagiaire.latest_stage_status) {
                  <span class="status-badge" [ngClass]="{
                    'en-attente': stagiaire.latest_stage_status?.includes('en_attente'),
                    'en-cours': stagiaire.latest_stage_status === 'stage_en_cours',
                    'termine': stagiaire.latest_stage_status === 'termine',
                    'annule': stagiaire.latest_stage_status === 'annule',
                    'expire': stagiaire.latest_stage_status === 'expire'
                  }">
                    {{ getStatusLabel(stagiaire.latest_stage_status) }}
                  </span>
                } @else {
                  <span class="no-stage">-</span>
                }
              </td>
              <td>{{ stagiaire.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>
                <button class="action-btn" title="Voir le profil">ğŸ‘ï¸</button>
                <button class="action-btn" title="Modifier">âœï¸</button>
                @if (stagiaire.has_active_stage) {
                  <button class="action-btn" title="Voir les stages">ğŸ“‹</button>
                }
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }

  <!-- Pagination controls -->
  @if (!loading && totalPages > 1) {
    <div class="pagination">
      <button class="pagination-btn" [disabled]="!hasPrevious" (click)="previousPage()">
        â† PrÃ©cÃ©dent
      </button>
      
      @if (currentPage > 3) {
        <button class="pagination-btn" (click)="goToPage(1)">1</button>
      }
      @if (currentPage > 4) {
        <span class="pagination-dots">...</span>
      }
      
      @for (page of getPageNumbers(); track page) {
        <button 
          class="pagination-btn" 
          [class.active]="page === currentPage"
          (click)="goToPage(page)">
          {{ page }}
        </button>
      }
      
      @if (currentPage < totalPages - 3) {
        <span class="pagination-dots">...</span>
      }
      @if (currentPage < totalPages - 2) {
        <button class="pagination-btn" (click)="goToPage(totalPages)">{{ totalPages }}</button>
      }
      
      <button class="pagination-btn" [disabled]="!hasNext" (click)="nextPage()">
        Suivant â†’
      </button>
    </div>
  }
  
  @if (!loading && !stagiaires.length) {
    <div>Aucun stagiaire trouvÃ©.</div>
  }
  